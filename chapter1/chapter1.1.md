# 1. SQL 처리 과정과 I/O

## 1.1 SQL 파싱과 최적화
 
### 1.1.1 구조적, 집합적, 선언적 질의 언어

- SQL은 기본적으로 '구조적'이고 '집합적'이고 '선언적'인 언어이다. 
- 결과집합을 만드는 '절차적'인 과정은, DBMS 내부에 '옵티마이저'가 수행한다. 

- SQL최적화 : DBMS 내부에서 프로시저를 작성하고 컴파일해서 실행 가능한 상태로 만드는 전 과정

### 1.1.2 SQL 최적화

#### SQL 실행 전 최적화 과정
1. SQL 파싱 : SQL 파서가 파싱 진행
    - 파싱 트리 생성
    - Syntax 체크 : 문법 오류 체크
    - Semantic 체크 : 존재하는 테이블 또는 컬럼을 사용했는지, 사용한 오브젝트에 대한 권한이 있는지 '의미상 오류' 확인

2. SQL 최적화
    - '옵티마이저'가 수행하는 단계이다. 
    - 미리 수집한 시스템 및 오브젝트 통계정보를 바탕으로, 다양한 실행경로를 생성해서 비교한 후 가장 효율적인 하나를 선택한다. 
    - 데이터베이스 성능을 결정하는 핵심 엔진!

3. 로우 소스 생성
    - '로우 소스 생성기'가 수행함
    - 옵티마이저가 선택한 실행결과를, 실행 가능한 코드 또는 프로시저 형태로 포맷하는 과정

### 1.1.3 SQL 옵티마니저

#### 옵티마이저의 최적화 단계
1. 실행계획 찾기 : 쓸만한 실행계획 찾기
2. 실행계획 예상비용 산정 : '데이터 딕셔너리'에 미리 수집해둔 '오브젝트 통계' 및 '시스템 통계정보'를 이용
3. 실행계획 선택 : 최저 비용으로 선택

### 1.1.4 실행계획과 비용

- 실행계획 : SQL옵티마이저 생성한 처리절차를 사용자가 확인할 수 있게 트리구조로 표현한 것
- 비용 : 쿼리를 수행하는 동안 발생할 것으로 예상되는 I/O 횟수 또는 예상소요 시간

### 1.1.5 옵티마이저 힌트

#### 힌트사용법
주석 기호에 '+'를 붙이면 된다. 

```sql
SELECT /*+ INDEX(A 고객_PK) */
    고객명, 연락처, 주소, 가입일시
   FROM 고객 A
WHERE 고객ID = '000000008';
```
#### 힌트 주의사항 
1. 힌트와 힌트 사이에 콤마(,)를 사용하면 첫 번쨰 힌트만 유효하다.

```sql
/*+ INDEX(A A_X01) INDEX(B B_X03) */  -- 모든 힌트가 유효함
/*+ INDEX(C), FULL(D) */              -- 첫 번쨰 힌트만 유효함
```

2. 스키마명까지 명시하면 안된다. (SCOTT.EMP 불가)

3. FROM 절에 ALIAS 지정했다면, 힌트에도 반드시 ALIAS 지정해야함



